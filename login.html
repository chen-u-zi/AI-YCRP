<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç™»å…¥èˆ‡è¨»å†Š - é’å°‘å¹´é˜²è©äº’å‹•å­¸ç¿’å¹³å°</title>
  <link rel="stylesheet" href="login.css">
</head>
<body>
  <header>
    <h1>ğŸ›¡ï¸ é’å°‘å¹´é˜²è©äº’å‹•å­¸ç¿’å¹³å°</h1>
    <a href="home.html" class="back-btn" onclick="goBack()" aria-label="è¿”å›é¦–é ">â† è¿”å›é¦–é </a>
  </header>

  <main>
    <div class="form-container">
      <div class="form-tabs">
        <button class="tab active" onclick="showForm('login')" aria-label="åˆ‡æ›åˆ°ç™»å…¥è¡¨å–®">
          ğŸ”‘ ç™»å…¥
        </button>
        <button class="tab" onclick="showForm('register')" aria-label="åˆ‡æ›åˆ°è¨»å†Šè¡¨å–®">
          ğŸ“ è¨»å†Š
        </button>
      </div>

      <div id="loginForm" class="form-content active">
        <h2>ğŸ” æœƒå“¡ç™»å…¥</h2>
        <form onsubmit="submitForm('login', event)">
          <div class="form-group">
            <label for="loginUsername">ä½¿ç”¨è€…åç¨±</label>
            <input type="text" id="loginUsername" placeholder="è«‹è¼¸å…¥ä½¿ç”¨è€…åç¨±" aria-label="è¼¸å…¥ä½¿ç”¨è€…åç¨±" required>
          </div>
          <div class="form-group">
            <label for="loginPassword">å¯†ç¢¼</label>
            <div style="position: relative;">
              <input type="password" id="loginPassword" placeholder="è«‹è¼¸å…¥å¯†ç¢¼" aria-label="è¼¸å…¥å¯†ç¢¼" required>
              <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')" aria-label="é¡¯ç¤º/éš±è—å¯†ç¢¼">
                ğŸ‘ï¸
              </button>
            </div>
          </div>
          <button type="submit" class="submit-btn" aria-label="æäº¤ç™»å…¥">
            ğŸš€ ç«‹å³ç™»å…¥
          </button>
        </form>
        
        <div style="margin-top: 2rem; padding: 1rem; background: rgba(59, 130, 246, 0.1); border-radius: 10px; font-size: 0.9rem;">
          <p><strong>ğŸ’¡ æ¸¬è©¦å¸³è™Ÿï¼š</strong></p>
          <p>å­¸ç”Ÿï¼š1000 / 1000</p>
          <p>æ•™å¸«ï¼š2000 / 2000</p>
          <p>å®¶é•·ï¼š3000 / 3000</p>
          <p>ç®¡ç†å“¡ï¼šadmin / admin</p>
        </div>
      </div>

      <div id="registerForm" class="form-content">
        <h2>ğŸ“‹ æ–°æœƒå“¡è¨»å†Š</h2>
        <form onsubmit="submitForm('register', event)">
          <div class="form-group">
            <label for="registerUsername">ä½¿ç”¨è€…åç¨±</label>
            <input type="text" id="registerUsername" placeholder="è«‹è¼¸å…¥ä½¿ç”¨è€…åç¨±" aria-label="è¼¸å…¥ä½¿ç”¨è€…åç¨±" required>
          </div>
          <div class="form-group">
            <label for="registerPassword">å¯†ç¢¼</label>
            <div style="position: relative;">
              <input type="password" id="registerPassword" placeholder="è«‹è¼¸å…¥å¯†ç¢¼ï¼ˆè‡³å°‘6ä½ï¼‰" aria-label="è¼¸å…¥å¯†ç¢¼" required minlength="6">
              <button type="button" class="password-toggle" onclick="togglePassword('registerPassword')" aria-label="é¡¯ç¤º/éš±è—å¯†ç¢¼">
                ğŸ‘ï¸
              </button>
            </div>
          </div>
          <div class="form-group">
            <label for="confirmPassword">ç¢ºèªå¯†ç¢¼</label>
            <div style="position: relative;">
              <input type="password" id="confirmPassword" placeholder="è«‹å†æ¬¡è¼¸å…¥å¯†ç¢¼" aria-label="ç¢ºèªå¯†ç¢¼" required>
              <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword')" aria-label="é¡¯ç¤º/éš±è—å¯†ç¢¼">
                ğŸ‘ï¸
              </button>
            </div>
          </div>
          <div class="form-group role-select">
            <label for="registerRole">é¸æ“‡èº«ä»½</label>
            <select id="registerRole" aria-label="é¸æ“‡ç”¨æˆ¶è§’è‰²" required>
              <option value="">è«‹é¸æ“‡æ‚¨çš„èº«ä»½</option>
              <option value="å­¸ç”Ÿ">ğŸ“ å­¸ç”Ÿ</option>
              <option value="æ•™å¸«">ğŸ‘¨â€ğŸ« æ•™å¸«</option>
              <option value="å®¶é•·">ğŸ‘ª å®¶é•·</option>
              <option value="ç³»çµ±ç®¡ç†å“¡">âš™ï¸ ç³»çµ±ç®¡ç†å“¡</option>
            </select>
          </div>
          <button type="submit" class="submit-btn" aria-label="æäº¤è¨»å†Š">
            âœ¨ ç«‹å³è¨»å†Š
          </button>
        </form>
      </div>
    </div>
  </main>

  <footer>
    <p>Â© 2025 æ©Ÿå™¨äººæƒ³æ”¾å‡åœ˜éšŠã€‚ä¿ç•™æ‰€æœ‰æ¬Šåˆ©ã€‚</p>
    <p>ğŸ¤– è‡´åŠ›æ–¼é’å°‘å¹´æ•¸ä½å®‰å…¨æ•™è‚²</p>
  </footer>

  <div class="modal" id="alertModal">
    <div class="modal-content">
      <div class="icon" id="modalIcon">â„¹ï¸</div>
      <p id="modalMessage"></p>
      <button onclick="closeModal()" id="modalButton">ç¢ºèª</button>
    </div>
  </div>

  <script>
    // é è¨­ç”¨æˆ¶è³‡æ–™
    const defaultUsers = {
      '1000': { password: '1000', role: 'å­¸ç”Ÿ', redirect: './student/index.html' },
      '1001': { password: '1001', role: 'å­¸ç”Ÿ', redirect: './student/index.html' },
      '2000': { password: '2000', role: 'æ•™å¸«', redirect: './teacher/index.html' },
      '3000': { password: '3000', role: 'å®¶é•·', redirect: './parent/index.html' },
      'admin': { password: 'admin', role: 'ç³»çµ±ç®¡ç†å“¡', redirect: './admin/index.html' }
    };

    // ç”¨æˆ¶è³‡æ–™åº«ï¼ˆä½¿ç”¨è¨˜æ†¶é«”å­˜å„²ï¼‰
    let users = { ...defaultUsers };

    // åˆ‡æ›è¡¨å–®
    function showForm(formType) {
      document.querySelectorAll('.form-content').forEach(form => {
        form.classList.remove('active');
      });
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });

      document.getElementById(formType + 'Form').classList.add('active');
      document.querySelector(`button[onclick="showForm('${formType}')"]`).classList.add('active');
      
      document.getElementById(formType + 'Form').querySelector('form').reset();
    }

    // åˆ‡æ›å¯†ç¢¼é¡¯ç¤º/éš±è—
    function togglePassword(inputId) {
      const input = document.getElementById(inputId);
      const button = input.nextElementSibling;
      
      if (input.type === 'password') {
        input.type = 'text';
        button.textContent = 'ğŸ™ˆ';
      } else {
        input.type = 'password';
        button.textContent = 'ğŸ‘ï¸';
      }
    }

    // è¡¨å–®æäº¤
    function submitForm(formType, event) {
      event.preventDefault();
      
      const submitButton = event.target.querySelector('.submit-btn');
      submitButton.classList.add('loading');
      submitButton.disabled = true;
      
      setTimeout(() => {
        if (formType === 'login') {
          handleLogin();
        } else {
          handleRegister();
        }
        
        submitButton.classList.remove('loading');
        submitButton.disabled = false;
      }, 1000);
    }

    // è™•ç†ç™»å…¥
    function handleLogin() {
      const username = document.getElementById('loginUsername').value.trim();
      const password = document.getElementById('loginPassword').value.trim();

      if (!username || !password) {
        showAlert('âŒ è«‹è¼¸å…¥ä½¿ç”¨è€…åç¨±å’Œå¯†ç¢¼ï¼', 'error');
        return;
      }

      if (users[username] && users[username].password === password) {
        showAlert(`âœ… ${users[username].role}ç™»å…¥æˆåŠŸï¼`, 'success');
        localStorage.setItem('role', users[username].role); // å„²å­˜è§’è‰²
        setTimeout(() => {
          closeModal(); // é—œé–‰æ¨¡æ…‹è¦–çª—
          window.location.href = users[username].redirect; // è·³è½‰åˆ°å°æ‡‰é é¢
        }, 1500); // å»¶é² 1.5 ç§’
      } else {
        showAlert('âŒ ä½¿ç”¨è€…åç¨±æˆ–å¯†ç¢¼éŒ¯èª¤ï¼', 'error');
      }
    }

    // è™•ç†è¨»å†Š
    function handleRegister() {
      const username = document.getElementById('registerUsername').value.trim();
      const password = document.getElementById('registerPassword').value.trim();
      const confirmPassword = document.getElementById('confirmPassword').value.trim();
      const role = document.getElementById('registerRole').value;

      if (!username || !password || !confirmPassword || !role) {
        showAlert('âŒ è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½ï¼', 'error');
        return;
      }

      if (password.length < 6) {
        showAlert('âŒ å¯†ç¢¼é•·åº¦è‡³å°‘éœ€è¦6ä½ï¼', 'error');
        return;
      }

      if (password !== confirmPassword) {
        showAlert('âŒ å¯†ç¢¼ç¢ºèªä¸ä¸€è‡´ï¼Œè«‹é‡æ–°è¼¸å…¥ï¼', 'error');
        return;
      }

      if (users[username]) {
        showAlert('âŒ æ­¤ä½¿ç”¨è€…åç¨±å·²è¢«è¨»å†Šï¼', 'error');
        return;
      }

      const redirectMap = {
        'å­¸ç”Ÿ': './student/index.html',
        'æ•™å¸«': './teacher/index.html',
        'å®¶é•·': './parent/index.html',
        'ç³»çµ±ç®¡ç†å“¡': './admin/index.html'
      };

      users[username] = {
        password: password,
        role: role,
        redirect: redirectMap[role]
      };

      showAlert(`ğŸ‰ ${role}è¨»å†ŠæˆåŠŸï¼`, 'success');
      setTimeout(() => {
        closeModal(); // é—œé–‰æ¨¡æ…‹è¦–çª—
        window.location.href = redirectMap[role]; // è·³è½‰åˆ°å°æ‡‰é é¢
      }, 2000); // å»¶é² 2 ç§’
    }

    // é¡¯ç¤ºæç¤ºæ¡†
    function showAlert(message, type = 'info') {
      const modal = document.getElementById('alertModal');
      const icon = document.getElementById('modalIcon');
      const messageEl = document.getElementById('modalMessage');
      const button = document.getElementById('modalButton');

      if (type === 'success') {
        icon.textContent = 'âœ…';
        button.style.background = 'linear-gradient(135deg, #059669, #047857)';
      } else if (type === 'error') {
        icon.textContent = 'âŒ';
        button.style.background = 'linear-gradient(135deg, #dc2626, #b91c1c)';
      } else {
        icon.textContent = 'â„¹ï¸';
        button.style.background = 'linear-gradient(135deg, #667eea, #764ba2)';
      }

      messageEl.textContent = message;
      modal.classList.add('active');
    }

    // é—œé–‰æç¤ºæ¡†
    function closeModal() {
      const modal = document.getElementById('alertModal');
      modal.classList.remove('active');
    }

    // è¿”å›é¦–é 
    function goBack() {
      showAlert('ğŸ  å³å°‡è¿”å›é¦–é ...', 'info');
      setTimeout(() => {
        window.history.back();
      }, 1000);
    }

    // é»æ“Šæ¨¡æ…‹æ¡†èƒŒæ™¯é—œé–‰
    document.getElementById('alertModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });

    // éµç›¤äº‹ä»¶
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeModal();
      }
    });

    // æ ¹æ“šURLéŒ¨é»åˆ‡æ›è¡¨å–®
    window.onload = function() {
      const hash = window.location.hash;
      if (hash === '#register') {
        showForm('register');
      } else {
        showForm('login');
      }
    };

    // è¡¨å–®é©—è­‰å¢å¼·
    document.addEventListener('DOMContentLoaded', function() {
      const passwordInput = document.getElementById('registerPassword');
      const confirmInput = document.getElementById('confirmPassword');
      
      if (passwordInput) {
        passwordInput.addEventListener('input', function() {
          const password = this.value;
          if (password.length > 0 && password.length < 6) {
            this.style.borderColor = '#dc2626';
          } else if (password.length >= 6) {
            this.style.borderColor = '#059669';
          }
        });
      }
      
      if (confirmInput) {
        confirmInput.addEventListener('input', function() {
          const password = document.getElementById('registerPassword').value;
          const confirm = this.value;
          if (confirm.length > 0) {
            if (password === confirm) {
              this.style.borderColor = '#059669';
            } else {
              this.style.borderColor = '#dc2626';
            }
          }
        });
      }
    });

    // å¯†ç¢¼å¼·åº¦æª¢æŸ¥å‡½æ•¸
    function getPasswordStrength(password) {
      let strength = 0;
      if (password.length >= 6) strength++;
      if (password.match(/[a-z]/)) strength++;
      if (password.match(/[A-Z]/)) strength++;
      if (password.match(/[0-9]/)) strength++;
      if (password.match(/[^a-zA-Z0-9]/)) strength++;
      return strength;
    }
  </script>
</body>
</html>