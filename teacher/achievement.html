<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆå°±ç³»çµ± - æ•™å¸«ç«¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .modal {
            display: none;
        }

        .modal.active {
            display: flex;
        }

        .badge-icon {
            width: 64px;
            height: 64px;
            object-fit: contain;
        }

        .grayscale {
            filter: grayscale(100%);
        }

        :root {
            --header-height: 64px;
            --sidebar-width: 256px;
            /* 16rem = 256px */
        }

        body {
            background: #f3f4f6;
            min-height: 100vh;
            font-family: 'Noto Sans TC', 'sans-serif';
        }

        header.header-fixed {
            position: fixed;
            left: 0;
            top: 0;
            right: 0;
            z-index: 40;
            height: var(--header-height);
            background: #fff;
            box-shadow: 0 2px 8px #0001;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 1.5rem;
        }

        aside.sidebar-fixed {
            position: fixed;
            left: 0;
            top: var(--header-height);
            bottom: 0;
            width: var(--sidebar-width);
            z-index: 30;
            background: #fff;
            box-shadow: 2px 0 8px #0001;
            padding: 1rem;
            overflow-y: auto;
        }

        .main-content {
            margin-top: var(--header-height);
            margin-left: var(--sidebar-width);
            padding: 2rem;
            min-height: calc(100vh - var(--header-height));
            /* ç¢ºä¿å…§å®¹ä¸è¢«é®ä½ */
            transition: margin .2s;
        }

        @media (max-width: 900px) {
            aside.sidebar-fixed {
                width: 13rem;
            }

            .main-content {
                margin-left: 13rem;
            }
        }

        @media (max-width: 700px) {
            aside.sidebar-fixed {
                width: 100vw;
                position: static;
                box-shadow: none;
            }

            .main-content {
                margin-left: 0;
            }
        }
    </style>
</head>

<body class="bg-gray-100 min-h-screen">
    <!-- å›ºå®š Header -->
    <header class="header-fixed">
        <div>
            <h1 class="text-xl font-semibold">é’å°‘å¹´é˜²è©äº’å‹•å­¸ç¿’å¹³å°</h1>
            <p class="text-sm text-blue-600">æˆç‚ºç¶²è·¯å®‰å…¨å°é”äºº</p>
        </div>
        <div class="flex gap-4 items-center">
            <div class="text-sm text-blue-800 font-semibold">ğŸ‘¨â€ğŸ« æ•™å¸«</div>
            <a href="../home.html" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">ç™»å‡º</a>
        </div>
    </header>
    <!-- å›ºå®šå´é‚Šæ¬„ -->
    <aside class="sidebar-fixed">
        <h2 class="text-xl font-bold mb-6 text-blue-800">æ•™å¸«ç®¡ç†é¸å–®</h2>
        <nav class="space-y-2">
            <a href="index.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ§‘â€ğŸ« æ•™å¸«ç®¡ç†æ¨¡çµ„</a>
            <a href="dashboard.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ“Š å„€è¡¨æ¿</a>
            <a href="student.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ‘¥ å­¸ç”Ÿç®¡ç†</a>
            <a href="scenario.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ“š æƒ…å¢ƒé¡Œåº«ç®¡ç†</a>
            <a href="knowledge.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ“– çŸ¥è­˜åº«ç®¡ç†</a>
            <a href="achievement.html" class="block px-4 py-2 rounded bg-blue-100 text-blue-900">ğŸ† æˆå°±ç³»çµ±</a>
            <a href="notification.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ“¢ å…¬å‘Šç®¡ç†</a>
            <a href="settings.html" class="block px-4 py-2 rounded hover:bg-blue-100">âš™ï¸ è¨­å®šèˆ‡æ”¯æ´</a>
        </nav>
    </aside>
    <!-- ä¸»å…§å®¹å€ -->
    <div class="main-content">
        <div class="flex-1 flex flex-col">
            <main class="flex-1 p-8">
                <!-- 1. æˆå°±å¾½ç« ç®¡ç† -->
                <section class="bg-white p-6 rounded-lg shadow mb-8">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-semibold">ğŸ† æˆå°±å¾½ç« ç®¡ç†</h2>
                        <button onclick="openBadgeModal()"
                            class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">æ–°å¢æˆå°±</button>
                    </div>
                    <div id="badgeList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                </section>
                <!-- 2. å­¸ç”Ÿæˆå°±å®Œæˆæƒ…æ³ -->
                <section class="bg-white p-6 rounded-lg shadow mb-8">
                    <h2 class="text-lg font-semibold mb-4">å­¸ç”Ÿæˆå°±çµ±è¨ˆ</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full table-auto">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="px-4 py-2 text-left">å­¸ç”Ÿå§“å</th>
                                    <th class="px-4 py-2 text-left">å®Œæˆå¾½ç« æ•¸</th>
                                    <th class="px-4 py-2 text-left">æœ€è¿‘ç²å¾—</th>
                                    <th class="px-4 py-2 text-left">é€²åº¦</th>
                                    <th class="px-4 py-2 text-left">è©³ç´°</th>
                                </tr>
                            </thead>
                            <tbody id="studentStatList">
                                <!-- å­¸ç”Ÿæˆå°±è³‡æ–™ç”±JSå‹•æ…‹å¡«å…¥ -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- å­¸ç”Ÿæˆå°±è©³ç´° Modal -->
                <div id="studentModal"
                    class="modal fixed inset-0 bg-black bg-opacity-50 items-center justify-center z-40">
                    <div class="bg-white p-6 rounded-lg w-full max-w-2xl mx-auto">
                        <h2 class="text-xl font-bold mb-4">å­¸ç”Ÿæˆå°±è©³ç´°</h2>
                        <p class="mb-4" id="studentName"></p>
                        <div id="studentBadgeDetail" class="grid grid-cols-2 gap-4"></div>
                        <div class="flex justify-end mt-4">
                            <button type="button" onclick="closeStudentModal()"
                                class="bg-gray-300 text-black px-4 py-2 rounded hover:bg-gray-400">é—œé–‰</button>
                        </div>
                    </div>
                </div>



                <!-- åœ˜éšŠé‚€è«‹ Modal -->
                <div id="teamInviteModal"
                    class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden">
                    <div class="bg-white p-6 rounded-lg w-full max-w-md">
                        <h2 class="text-xl font-bold mb-4">åœ˜éšŠé‚€è«‹</h2>
                        <form onsubmit="sendTeamInvite(event)">
                            <div class="mb-4">
                                <label class="block mb-1 text-blue-800">åœ˜éšŠåç¨±</label>
                                <input type="text" class="w-full border rounded px-3 py-2" placeholder="è¼¸å…¥åœ˜éšŠåç¨±"
                                    required>
                            </div>
                            <div class="mb-4">
                                <label class="block mb-1 text-blue-800">å­¸ç”Ÿå¸³è™Ÿï¼ˆå¯å¤šå€‹ï¼Œä»¥é€—è™Ÿåˆ†éš”ï¼‰</label>
                                <input type="text" class="w-full border rounded px-3 py-2" placeholder="å¦‚ï¼šS001,S002"
                                    required>
                            </div>
                            <div class="flex justify-end space-x-2">
                                <button type="button" onclick="closeTeamInviteModal()"
                                    class="bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400">å–æ¶ˆ</button>
                                <button type="submit"
                                    class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">é€å‡ºé‚€è«‹</button>
                            </div>
                        </form>
                    </div>
                </div>
            </main>
            <footer class="text-center p-4 bg-white shadow">Â© 2025 æ©Ÿå™¨äººæƒ³æ”¾å‡åœ˜éšŠã€‚ä¿ç•™æ‰€æœ‰æ¬Šåˆ©ã€‚</footer>

            <script>
                // --- å‡è³‡æ–™ï¼ˆä¸»é¡Œå…¨é¢é’å°‘å¹´åŒ–ï¼‰---
                let badges = [
                    { id: 1, name: "ç¤¾ç¾¤å®ˆè­·è€…", icon: "social.png", condition: "åƒåŠ 3æ¬¡ç¤¾ç¾¤è©é¨™æƒ…å¢ƒä¸”æ­£ç¢ºç‡80%ä»¥ä¸Š", status: "active" },
                    { id: 2, name: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", icon: "shopping.jpg", condition: "å®Œæˆç¶²è³¼è©é¨™é¡Œ5é¡Œä¸”æ­£ç¢ºç‡80%ä»¥ä¸Š", status: "active" },
                    { id: 3, name: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", icon: "game.jpg", condition: "ç ´è§£éŠæˆ²è©é¨™é¡Œ3é¡Œä¸”æ­£ç¢ºç‡100%", status: "active" },
                    { id: 4, name: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", icon: "curious.png", condition: "é¦–æ¬¡å®Œæˆæ‰€æœ‰ä¸»é¡Œçš„æƒ…å¢ƒæ¸¬é©—", status: "active" },
                    { id: 5, name: "æŠ•è³‡å®ˆé–€å“¡", icon: "investment.png", condition: "æŠ•è³‡è©é¨™é¡Œé”90åˆ†", status: "inactive" },
                    { id: 6, name: "AIçŸ¥è­˜æ¢ç´¢è€…", icon: "ai.jpg", condition: "AIæ·±å½é¡Œå…¨å°", status: "active" }
                ];
                let students = [
                    {
                        name: "è¨±å·§èŠ¸", badgeNum: 4, totalBadge: 6, lastBadge: "AIçŸ¥è­˜æ¢ç´¢è€…", percent: 67, badges: [
                            { name: "ç¤¾ç¾¤å®ˆè­·è€…", date: "2025-07-01", unlocked: true, icon: "social.png" },
                            { name: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", date: "2025-07-02", unlocked: true, icon: "shopping.jpg" },
                            { name: "AIçŸ¥è­˜æ¢ç´¢è€…", date: "2025-07-03", unlocked: true, icon: "ai.jpg" },
                            { name: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", date: "2025-07-04", unlocked: true, icon: "curious.png" },
                            { name: "æŠ•è³‡å®ˆé–€å“¡", date: "", unlocked: false, icon: "investment.png" },
                            { name: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", date: "", unlocked: false, icon: "game.jpg" }
                        ]
                    },
                    {
                        name: "é™³å®‡æ˜Š", badgeNum: 3, totalBadge: 6, lastBadge: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", percent: 50, badges: [
                            { name: "ç¤¾ç¾¤å®ˆè­·è€…", date: "2025-07-01", unlocked: true, icon: "social.png" },
                            { name: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", date: "2025-07-03", unlocked: true, icon: "shopping.jpg" },
                            { name: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", date: "2025-07-04", unlocked: true, icon: "curious.png" },
                            { name: "AIçŸ¥è­˜æ¢ç´¢è€…", date: "", unlocked: false, icon: "ai.jpg" },
                            { name: "æŠ•è³‡å®ˆé–€å“¡", date: "", unlocked: false, icon: "investment.png" },
                            { name: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", date: "", unlocked: false, icon: "game.jpg" }
                        ]
                    },
                    {
                        name: "è˜‡å‰åº­", badgeNum: 2, totalBadge: 6, lastBadge: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", percent: 33, badges: [
                            { name: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", date: "2025-07-02", unlocked: true, icon: "shopping.jpg" },
                            { name: "ç¤¾ç¾¤å®ˆè­·è€…", date: "2025-07-04", unlocked: true, icon: "social.png" },
                            { name: "AIçŸ¥è­˜æ¢ç´¢è€…", date: "", unlocked: false, icon: "ai.jpg" },
                            { name: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", date: "", unlocked: false, icon: "curious.png" },
                            { name: "æŠ•è³‡å®ˆé–€å“¡", date: "", unlocked: false, icon: "investment.png" },
                            { name: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", date: "", unlocked: false, icon: "game.jpg" }
                        ]
                    },
                    {
                        name: "é‚±æ€å¦¤", badgeNum: 5, totalBadge: 6, lastBadge: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", percent: 83, badges: [
                            { name: "ç¤¾ç¾¤å®ˆè­·è€…", date: "2025-07-01", unlocked: true, icon: "social.png" },
                            { name: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", date: "2025-07-02", unlocked: true, icon: "shopping.jpg" },
                            { name: "AIçŸ¥è­˜æ¢ç´¢è€…", date: "2025-07-03", unlocked: true, icon: "ai.jpg" },
                            { name: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", date: "2025-07-04", unlocked: true, icon: "curious.png" },
                            { name: "æŠ•è³‡å®ˆé–€å“¡", date: "2025-07-06", unlocked: true, icon: "investment.png" },
                            { name: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", date: "2025-07-08", unlocked: true, icon: "game.jpg" }
                        ]
                    },
                    {
                        name: "åŠ‰äº­ç¾½", badgeNum: 1, totalBadge: 6, lastBadge: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", percent: 17, badges: [
                            { name: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", date: "2025-07-02", unlocked: true, icon: "shopping.jpg" },
                            { name: "ç¤¾ç¾¤å®ˆè­·è€…", date: "", unlocked: false, icon: "social.png" },
                            { name: "AIçŸ¥è­˜æ¢ç´¢è€…", date: "", unlocked: false, icon: "ai.jpg" },
                            { name: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", date: "", unlocked: false, icon: "curious.png" },
                            { name: "æŠ•è³‡å®ˆé–€å“¡", date: "", unlocked: false, icon: "investment.png" },
                            { name: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", date: "", unlocked: false, icon: "game.jpg" }
                        ]
                    },
                    {
                        name: "å»–æ”¿è¾°", badgeNum: 3, totalBadge: 6, lastBadge: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", percent: 50, badges: [
                            { name: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", date: "2025-07-03", unlocked: true, icon: "curious.png" },
                            { name: "ç¤¾ç¾¤å®ˆè­·è€…", date: "2025-07-04", unlocked: true, icon: "social.png" },
                            { name: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", date: "2025-07-05", unlocked: true, icon: "game.jpg" },
                            { name: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", date: "", unlocked: false, icon: "shopping.jpg" },
                            { name: "AIçŸ¥è­˜æ¢ç´¢è€…", date: "", unlocked: false, icon: "ai.jpg" },
                            { name: "æŠ•è³‡å®ˆé–€å“¡", date: "", unlocked: false, icon: "investment.png" }
                        ]
                    },
                    {
                        name: "æ—è¾°ä½‘", badgeNum: 2, totalBadge: 6, lastBadge: "AIçŸ¥è­˜æ¢ç´¢è€…", percent: 33, badges: [
                            { name: "AIçŸ¥è­˜æ¢ç´¢è€…", date: "2025-07-06", unlocked: true, icon: "ai.jpg" },
                            { name: "æŠ•è³‡å®ˆé–€å“¡", date: "", unlocked: false, icon: "investment.png" },
                            { name: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", date: "", unlocked: false, icon: "curious.png" },
                            { name: "ç¤¾ç¾¤å®ˆè­·è€…", date: "", unlocked: false, icon: "social.png" },
                            { name: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", date: "", unlocked: false, icon: "shopping.jpg" },
                            { name: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", date: "", unlocked: false, icon: "game.jpg" }
                        ]
                    },
                    {
                        name: "æèŠ·ç‘„", badgeNum: 4, totalBadge: 6, lastBadge: "æŠ•è³‡å®ˆé–€å“¡", percent: 67, badges: [
                            { name: "æŠ•è³‡å®ˆé–€å“¡", date: "2025-07-05", unlocked: true, icon: "investment.png" },
                            { name: "AIçŸ¥è­˜æ¢ç´¢è€…", date: "2025-07-06", unlocked: true, icon: "ai.jpg" },
                            { name: "ç¤¾ç¾¤å®ˆè­·è€…", date: "2025-07-07", unlocked: true, icon: "social.png" },
                            { name: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", date: "2025-07-08", unlocked: true, icon: "game.jpg" },
                            { name: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", date: "", unlocked: false, icon: "curious.png" },
                            { name: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", date: "", unlocked: false, icon: "shopping.jpg" }
                        ]
                    },
                    {
                        name: "æ±Ÿå®œæ¨º", badgeNum: 2, totalBadge: 6, lastBadge: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", percent: 33, badges: [
                            { name: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", date: "2025-07-08", unlocked: true, icon: "game.jpg" },
                            { name: "ç¤¾ç¾¤å®ˆè­·è€…", date: "2025-07-09", unlocked: true, icon: "social.png" },
                            { name: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", date: "", unlocked: false, icon: "curious.png" },
                            { name: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", date: "", unlocked: false, icon: "shopping.jpg" },
                            { name: "AIçŸ¥è­˜æ¢ç´¢è€…", date: "", unlocked: false, icon: "ai.jpg" },
                            { name: "æŠ•è³‡å®ˆé–€å“¡", date: "", unlocked: false, icon: "investment.png" }
                        ]
                    },
                    {
                        name: "è¶™å† å®‡", badgeNum: 5, totalBadge: 6, lastBadge: "AIçŸ¥è­˜æ¢ç´¢è€…", percent: 83, badges: [
                            { name: "ç¤¾ç¾¤å®ˆè­·è€…", date: "2025-07-01", unlocked: true, icon: "social.png" },
                            { name: "ç¶²è³¼è¦‹ç¿’ç”Ÿ", date: "2025-07-02", unlocked: true, icon: "shopping.jpg" },
                            { name: "AIçŸ¥è­˜æ¢ç´¢è€…", date: "2025-07-03", unlocked: true, icon: "ai.jpg" },
                            { name: "ç¶²å®‰å¥½å¥‡å¯¶å¯¶", date: "2025-07-04", unlocked: true, icon: "curious.png" },
                            { name: "æŠ•è³‡å®ˆé–€å“¡", date: "2025-07-05", unlocked: true, icon: "investment.png" },
                            { name: "é›»ç©é¨™è¡“å‰‹æ˜Ÿ", date: "", unlocked: false, icon: "game.jpg" }
                        ]
                    }
                ];

                // å¾½ç« åˆ—è¡¨æ¸²æŸ“
                function renderBadgeList() {
                    const el = document.getElementById('badgeList');
                    el.innerHTML = '';
                    badges.forEach(b => {
                        el.innerHTML += `
                    <div class="${b.status === 'active' ? 'bg-blue-100' : 'bg-gray-100'} p-4 rounded shadow flex flex-col items-center">
                        <img src="${b.icon}" alt="${b.name}" class="badge-icon mb-2 ${b.status !== 'active' ? 'grayscale' : ''}">
                        <h3 class="text-md font-bold">${b.name}</h3>
                        <p class="text-sm text-gray-600 mb-1">${b.condition}</p>
                        <p class="text-sm"><span class="inline-block px-2 py-1 rounded ${b.status === 'active' ? 'bg-green-200 text-green-800' : 'bg-gray-300 text-gray-800'}">${b.status === 'active' ? 'ä¸Šæ¶ä¸­' : 'æœªå•Ÿç”¨'}</span></p>
                        <div class="mt-2 space-x-2">
                            <button onclick="editBadge(${b.id})" class="text-blue-500 hover:underline">ç·¨è¼¯</button>
                            <button onclick="delBadge(${b.id})" class="text-red-500 hover:underline">åˆªé™¤</button>
                            <button onclick="previewBadge('${b.icon}','${b.name}')" class="text-blue-500 hover:underline">é è¦½</button>
                        </div>
                    </div>`;
                    });
                }
                // å­¸ç”Ÿæˆå°±çµ±è¨ˆ
                function renderStudentStat() {
                    const el = document.getElementById('studentStatList');
                    el.innerHTML = '';
                    students.forEach((s, idx) => {
                        el.innerHTML += `
                    <tr class="border-t">
                        <td class="px-4 py-2">${s.name}</td>
                        <td class="px-4 py-2">${s.badgeNum}/${s.totalBadge}</td>
                        <td class="px-4 py-2">${s.lastBadge}</td>
                        <td class="px-4 py-2">
                            <div class="w-full bg-gray-300 rounded-full h-2.5">
                                <div class="bg-blue-600 h-2.5 rounded-full" style="width: ${s.percent}%"></div>
                            </div>
                        </td>
                        <td class="px-4 py-2">
                            <button onclick="openStudentModal(${idx})" class="text-blue-500 hover:underline">æŸ¥çœ‹</button>
                        </td>
                    </tr>`;
                    });
                }
                // å¾½ç« å­¸ç”Ÿè¦–è§’é è¦½
                function renderBadgePreview() {
                    const el = document.getElementById('badgePreview');
                    el.innerHTML = '';
                    badges.forEach(b => {
                        el.innerHTML += `
                    <div class="text-center">
                        <img src="${b.icon}" alt="${b.name}" class="badge-icon mx-auto ${b.status !== 'active' ? 'grayscale' : ''}">
                        <p class="text-sm font-semibold">${b.name}</p>
                        <p class="text-xs text-gray-600">${b.status === 'active' ? 'å·²è§£é–' : 'æœªè§£é–'}</p>
                    </div>
                `;
                    });
                }
                // ç·¨è¼¯/æ–°å¢å¾½ç« 
                let editBadgeId = null;
                function openBadgeModal(edit = false) {
                    document.getElementById('badgeModal').classList.add('active');
                    if (edit && editBadgeId) {
                        let b = badges.find(x => x.id === editBadgeId);
                        document.getElementById('badgeModalTitle').innerText = "ç·¨è¼¯æˆå°±";
                        document.getElementById('badgeName').value = b.name;
                        document.getElementById('badgeStatus').value = b.status;
                        // ä¸åšæ¢ä»¶ç´°ç¯€å’Œiconç·¨è¼¯demo
                    } else {
                        editBadgeId = null;
                        document.getElementById('badgeModalTitle').innerText = "æ–°å¢æˆå°±";
                        document.getElementById('badgeName').value = '';
                        document.getElementById('badgeStatus').value = 'active';
                    }
                }
                function closeBadgeModal() {
                    document.getElementById('badgeModal').classList.remove('active');
                    editBadgeId = null;
                }
                function saveBadge(e) {
                    e.preventDefault();
                    // å¯¦ä½œç•¥ï¼Œåƒ…é‡ç¹ª
                    closeBadgeModal();
                    renderBadgeList(); renderBadgePreview();
                }
                function editBadge(id) {
                    editBadgeId = id;
                    openBadgeModal(true);
                }
                function delBadge(id) {
                    if (confirm("ç¢ºå®šåˆªé™¤ï¼Ÿ")) {
                        badges = badges.filter(b => b.id !== id);
                        renderBadgeList(); renderBadgePreview();
                    }
                }
                function previewBadge(icon, name) {
                    alert(`é è¦½å¾½ç« ï¼š${name}`);
                }
                // å­¸ç”ŸModal
                function openStudentModal(idx) {
                    document.getElementById('studentModal').classList.add('active');
                    let s = students[idx];
                    document.getElementById('studentName').innerText = 'å­¸ç”Ÿå§“åï¼š' + s.name;
                    let html = '';
                    s.badges.forEach(b => {
                        html += `
                    <div class="text-center">
                        <img src="${b.icon}" alt="${b.name}" class="badge-icon mx-auto ${!b.unlocked ? 'grayscale' : ''}">
                        <p class="text-sm font-semibold">${b.name}</p>
                        <p class="text-xs text-gray-600">${b.unlocked ? 'å·²è§£é–ï¼š' + b.date : 'æœªè§£é–'}</p>
                    </div>`;
                    });
                    document.getElementById('studentBadgeDetail').innerHTML = html;
                }
                function closeStudentModal() {
                    document.getElementById('studentModal').classList.remove('active');
                }

                function openTeamInviteModal() {
                    document.getElementById('teamInviteModal').classList.remove('hidden');
                }
                function closeTeamInviteModal() {
                    document.getElementById('teamInviteModal').classList.add('hidden');
                }
                function sendTeamInvite(e) {
                    e.preventDefault();
                    // é€™è£¡å¯åŠ é€å‡ºé‚€è«‹çš„é‚è¼¯
                    alert('é‚€è«‹å·²é€å‡ºï¼');
                    closeTeamInviteModal();
                }
                // åˆå§‹åŒ–
                document.addEventListener('DOMContentLoaded', () => {
                    renderBadgeList();
                    renderStudentStat();
                    renderBadgePreview();
                });
            </script>

</body>

</html>