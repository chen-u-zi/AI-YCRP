<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>è¦ªå¸«è¯çµ¡ - æ•™å¸«ç«¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .chat-bubble { border-radius: 1rem; padding: .6em 1.2em; max-width: 75%; }
        .chat-right { background: #dbeafe; color: #1e3a8a; align-self: flex-end;}
        .chat-left { background: #f1f5f9; color: #334155; align-self: flex-start;}
        .chat-meta { font-size:.75em; color:#64748b;}
        .sidebar-link-active { background: #e0e7ff; color: #3730a3; font-weight: bold;}
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex">
    <!-- å´é‚Šæ¬„ï¼ˆåƒç…§ä½ çš„æ•™å¸«ç«¯æ¨¡çµ„ï¼‰ -->
    <aside class="w-64 bg-white shadow-md h-screen p-4 flex flex-col">
        <h2 class="text-xl font-bold mb-6 text-blue-800">æ•™å¸«ç®¡ç†é¸å–®</h2>
        <nav class="space-y-2 flex-1">
            <a href="dashboard.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ“Š å„€è¡¨æ¿</a>
            <a href="student.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ‘¥ å­¸ç”Ÿç®¡ç†</a>
            <a href="scenario.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ“š æƒ…å¢ƒé¡Œåº«ç®¡ç†</a>
            <a href="knowledge.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ“– çŸ¥è­˜åº«ç®¡ç†</a>
            <a href="achievement.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ† æˆå°±ç³»çµ±</a>
            <a href="notification.html" class="block px-4 py-2 rounded hover:bg-blue-100">ğŸ“¢ å…¬å‘Šç®¡ç†</a>
            <a href="message.html" class="block px-4 py-2 sidebar-link-active rounded">ğŸ’¬ è¦ªå¸«è¯çµ¡</a>
            <a href="settings.html" class="block px-4 py-2 rounded hover:bg-blue-100">âš™ï¸ è¨­å®šèˆ‡æ”¯æ´</a>
        </nav>
    </aside>
    <!-- ä¸»å…§å®¹ -->
    <div class="flex-1 flex flex-col">
        <!-- é ‚éƒ¨å°è¦½ -->
        <header class="bg-white shadow p-4 flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <h1 class="text-xl font-bold">é’å°‘å¹´é˜²è©äº’å‹•å­¸ç¿’å¹³å°</h1>
                <span class="text-sm text-blue-700">è¦ªå¸«å³æ™‚è¯çµ¡</span>
            </div>
            <div class="flex items-center space-x-4">
                <span class="text-sm text-blue-800 font-semibold">ğŸ‘¨â€ğŸ« ç‹è€å¸«</span>
                <a href="index.html" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">ç™»å‡º</a>
            </div>
        </header>

        <!-- èŠå¤©ä¸»é«” -->
        <main class="flex-1 p-6 flex gap-6">
            <!-- å®¶é•·åˆ—è¡¨ -->
            <aside class="w-72 bg-white rounded shadow-md flex flex-col">
                <h2 class="p-4 font-semibold border-b">å®¶é•·åˆ—è¡¨</h2>
                <div id="parentList" class="flex-1 overflow-y-auto">
                    <!-- JSå‹•æ…‹ç”¢ç”Ÿå®¶é•·æ¸…å–® -->
                </div>
                <div class="p-3 border-t">
                    <button onclick="newGroupMsg()" class="w-full bg-blue-500 text-white rounded py-2 hover:bg-blue-600">âœ‰ï¸ ç¾¤ç™¼è¨Šæ¯</button>
                </div>
            </aside>
            <!-- å°è©±å€ -->
            <section class="flex-1 flex flex-col bg-white rounded shadow-md">
                <div class="flex items-center px-6 py-3 border-b gap-2">
                    <span class="text-blue-600 font-semibold" id="chatTarget">è«‹é¸æ“‡å®¶é•·</span>
                </div>
                <div id="chatBox" class="flex-1 flex flex-col gap-2 p-6 overflow-y-auto" style="min-height:340px;">
                    <!-- JSå‹•æ…‹ç”¢ç”Ÿè¨Šæ¯ -->
                </div>
                <div class="px-6 py-4 border-t flex items-center gap-2">
                    <input type="text" id="msgInput" class="flex-1 border rounded px-3 py-2" placeholder="è¼¸å…¥è¨Šæ¯ï¼ˆEnteré€å‡ºï¼‰" onkeydown="if(event.key==='Enter'){sendMsg()}">
                    <button onclick="sendMsg()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">é€å‡º</button>
                </div>
            </section>
        </main>
    </div>

    <script>
        // ===== æ¨¡æ“¬è³‡æ–™å€ =====
        let parents = [
            {id:1, name:"é™³å°æ˜å®¶é•·", lastMsg:"è€å¸«æ‚¨å¥½ï½", unread:2, child:"é™³å°æ˜", online:true},
            {id:2, name:"æ—å°èŠ³å®¶é•·", lastMsg:"æ”¶åˆ°ï¼Œè¬è¬è€å¸«", unread:0, child:"æ—å°èŠ³", online:false},
            {id:3, name:"æå¤§è¡›å®¶é•·", lastMsg:"æˆ‘å®¶å­©å­æœ€è¿‘...", unread:0, child:"æå¤§è¡›", online:true}
        ];
        let messages = {
            1: [
                {from:'parent', name:"é™³å°æ˜å®¶é•·", time:"09:01", text:"è€å¸«æ‚¨å¥½ï½"},
                {from:'teacher', name:"ç‹è€å¸«", time:"09:02", text:"æ‚¨å¥½ï¼Œæœ‰ä»»ä½•å­¸ç¿’å•é¡Œéƒ½æ­¡è¿è¯çµ¡ï¼"},
                {from:'parent', name:"é™³å°æ˜å®¶é•·", time:"09:05", text:"æƒ³è«‹å•é€™æ¬¡æ¨¡æ“¬æ¸¬é©—æœ‰å¼±é»åˆ†æå ±å‘Šå—ï¼Ÿ"}
            ],
            2: [
                {from:'parent', name:"æ—å°èŠ³å®¶é•·", time:"09:10", text:"æ”¶åˆ°ï¼Œè¬è¬è€å¸«"}
            ],
            3: [
                {from:'parent', name:"æå¤§è¡›å®¶é•·", time:"08:35", text:"æˆ‘å®¶å­©å­æœ€è¿‘ç¶²è·¯æ™‚é–“å¢åŠ å¾ˆå¤š..."}
            ]
        };
        let currentParentId = null;

        // ===== JSäº’å‹•å€ =====
        function renderParentList(){
            const el = document.getElementById('parentList');
            el.innerHTML = '';
            parents.forEach(p=>{
                el.innerHTML += `
                    <div onclick="selectParent(${p.id})" class="cursor-pointer flex items-center px-4 py-3 gap-3 hover:bg-blue-50 border-b ${currentParentId===p.id?'bg-blue-100':''}">
                        <div class="rounded-full bg-blue-200 w-10 h-10 flex items-center justify-center font-bold text-blue-700">${p.name.charAt(0)}</div>
                        <div class="flex-1">
                            <div class="font-semibold">${p.name} <span class="text-xs text-gray-400">${p.online?'ğŸŸ¢':'âšª'}</span></div>
                            <div class="text-xs text-gray-500">${p.lastMsg}</div>
                        </div>
                        ${p.unread>0?`<div class="ml-1 bg-red-500 text-white rounded-full px-2 text-xs">${p.unread}</div>`:''}
                    </div>
                `;
            });
        }
        function selectParent(pid){
            currentParentId = pid;
            // å·²è®€è™•ç†
            parents.forEach(p=>{if(p.id===pid) p.unread=0;});
            renderParentList();
            // é¡¯ç¤ºå°è©±
            document.getElementById('chatTarget').innerText = parents.find(p=>p.id===pid).name + "ï¼ˆ" + parents.find(p=>p.id===pid).child + "ï¼‰";
            renderChat();
        }
        function renderChat(){
            const el = document.getElementById('chatBox');
            el.innerHTML = '';
            if(!currentParentId){ el.innerHTML = '<div class="text-gray-400 text-center mt-12">è«‹å…ˆé¸æ“‡å®¶é•·é–‹å§‹å°è©±</div>'; return;}
            (messages[currentParentId]||[]).forEach(msg=>{
                el.innerHTML += `
                <div class="flex flex-col ${msg.from==='teacher'?'items-end':'items-start'}">
                    <div class="chat-bubble ${msg.from==='teacher'?'chat-right':'chat-left'}">${msg.text}</div>
                    <span class="chat-meta">${msg.from==='teacher'?'æˆ‘':msg.name} ${msg.time}</span>
                </div>
                `;
            });
            el.scrollTop = el.scrollHeight;
        }
        function sendMsg(){
            const input = document.getElementById('msgInput');
            let txt = input.value.trim();
            if(!currentParentId || !txt) return;
            if(!messages[currentParentId]) messages[currentParentId]=[];
            let now = new Date();
            let time = now.getHours().toString().padStart(2,'0')+':'+now.getMinutes().toString().padStart(2,'0');
            messages[currentParentId].push({from:'teacher', name:"ç‹è€å¸«", time, text:txt});
            input.value = '';
            renderChat();
        }
        function newGroupMsg(){
            alert("ç¾¤ç™¼åŠŸèƒ½é–‹ç™¼ä¸­ï¼Œå°‡å¯ä¸€éµå‚³é€è¨Šæ¯çµ¦å…¨éƒ¨å®¶é•·ã€‚");
        }
        // ===== åˆå§‹åŒ– =====
        document.addEventListener('DOMContentLoaded', ()=>{
            renderParentList();
            renderChat();
        });
    </script>
</body>
</html>
